var express=require("express"),router=express.Router();module.exports=function(e){return router.get("/success",function(e,u){u.send({state:"success",user:e.user?e.user:null})}),router.get("/failure",function(e,u){u.send({state:"failure",user:null,message:"Invalid username or password"})}),router.post("/login",e.authenticate("login",{successRedirect:"/auth/success",failureRedirect:"/auth/failure"})),router.post("/signup",e.authenticate("signup",{successRedirect:"/auth/success",failureRedirect:"/auth/failure"})),router.get("/signout",function(e,u){e.logout(),u.redirect("/")}),router};